<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chats</title>
<style>
* { box-sizing: border-box; font-family: system-ui, Arial; }
body {
  margin: 0;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #0f1220;
  color: white;
}

/* Sidebar */
#sidebar {
  width: 260px;
  height: 80vh;
  background: #151935;
  padding: 10px;
  display: flex;
  flex-direction: column;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
}


#chatList {
  flex: 1;
  overflow-y: auto;
}

.chat-btn {
  width: 100%;
  padding: 12px;
  margin-bottom: 6px;
  background: #1f2455;
  border: none;
  color: white;
  border-radius: 6px;
  cursor: pointer;
  text-align: left;
}
.chat-btn:hover {
  background: #2a30ff;
}

#createBtn {
  padding: 12px;
  border: none;
  border-radius: 6px;
  background: #2a30ff;
  color: white;
  cursor: pointer;
}

/* Popup */
#popup {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  align-items: center;
  justify-content: center;
}

#popupBox {
  background: #151935;
  padding: 20px;
  border-radius: 8px;
  width: 280px;
}

#popupBox input {
  width: 100%;
  padding: 10px;
  margin-bottom: 10px;
}

#popupBox button {
  width: 100%;
  padding: 10px;
  border: none;
  background: #2a30ff;
  color: white;
  border-radius: 6px;
  cursor: pointer;
}

@media (max-width: 600px) {
  #sidebar {
    width: 95vw;
    height: 90vh;
  }
}

</style>
</head>
<body>

<div id="sidebar">
  <div id="chatList"></div>
  <button id="createBtn">+ Create Chat</button>
</div>

<div id="popup">
  <div id="popupBox">
    <h3>Create Chat</h3>
    <input id="chatNameInput" placeholder="Chat name">
    <button id="createChatConfirm">Create</button>
  </div>
</div>

<script>
/* ---------- STORAGE INIT ---------- */
let chats = JSON.parse(localStorage.getItem("chats"));
if (!chats) {
  chats = {};
  localStorage.setItem("chats", JSON.stringify(chats));
}

/* ---------- RENDER CHAT LIST ---------- */
function renderChats() {
  const chatList = document.getElementById("chatList");
  chatList.innerHTML = "";

  Object.keys(chats).forEach(chatName => {
    const btn = document.createElement("button");
    btn.className = "chat-btn";
    btn.textContent = chatName;
    btn.onclick = () => {
      window.location.href = `chat.html?chat=${encodeURIComponent(chatName)}`;
    };
    chatList.appendChild(btn);
  });
}

renderChats();

/* ---------- POPUP LOGIC ---------- */
const popup = document.getElementById("popup");
document.getElementById("createBtn").onclick = () => {
  popup.style.display = "flex";
};

popup.onclick = e => {
  if (e.target === popup) popup.style.display = "none";
};

/* ---------- CREATE CHAT ---------- */
document.getElementById("createChatConfirm").onclick = () => {
  const name = document.getElementById("chatNameInput").value.trim();
  if (!name) return;

  if (!chats[name]) {
    chats[name] = {
      messages: [],
      createdAt: Date.now()
    };
    localStorage.setItem("chats", JSON.stringify(chats));
  }

  window.location.href = `chat.html?chat=${encodeURIComponent(name)}`;
};
</script>

</body>
</html>
